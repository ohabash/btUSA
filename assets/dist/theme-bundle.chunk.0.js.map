{"version":3,"sources":["webpack:///./assets/js/theme/gift-certificate.js"],"names":["GiftCertificate","context","$certBalanceForm","$","addClass","purchaseModel","recipientName","val","length","recipientEmail","formModel","email","senderName","senderEmail","customAmount","value","min","max","setAmount","options","found","forEach","option","$purchaseForm","$customAmounts","find","purchaseValidator","nod","submit","delay","$element","data","minFormatted","maxFormatted","add","selector","validate","cb","numberVal","Number","errorMessage","result","toName","toEmail","fromName","fromEmail","triggeredBy","certTheme","get","checked","agreeToTerms","balanceVal","checkCertBalanceValidator","on","performCheck","areAll","event","preventDefault","click","modal","defaultModal","previewUrl","currentTarget","serialize","open","api","getPage","err","content","updateContent","previewError","wrap","$balanceForm","balanceValidator","giftCertChecker","PageManager"],"mappings":";;;;;;;;;;;;;;;8yBAQqBA,gB,gEACjB,yBAAYC,OAAZ,CAAqB,iFACjB,uBADiB,EAEjB,MAAKA,OAAL,CAAeA,OAAf,CAEA,GAAMC,kBAAmBC,8CAACA,CAAC,2BAAF,CAAzB,CACAA,8CAACA,CAAC,MAAF,EAAUC,QAAV,CAAmB,MAAnB,EACA,GAAMC,eAAgB,CAClBC,aADkB,wBACJC,GADI,CACC,CACf,MAAOA,KAAIC,MACd,CAHiB,CAIlBC,cAJkB,0BAIM,CACpB,MAAOC,sEAASA,CAACC,KAAV,4EAAS,WACnB,CANiB,CAOlBC,UAPkB,qBAOPL,GAPO,CAOF,CACZ,MAAOA,KAAIC,MACd,CATiB,CAUlBK,WAVkB,uBAUG,CACjB,MAAOH,sEAASA,CAACC,KAAV,4EAAS,WACnB,CAZiB,CAalBG,YAbkB,uBAaLC,KAbK,CAaEC,GAbF,CAaOC,GAbP,CAaY,CAC1B,MAAOF,QAASA,OAASC,GAAlB,EAAyBD,OAASE,GAC5C,CAfiB,CAgBlBC,SAhBkB,oBAgBRH,KAhBQ,CAgBDI,OAhBC,CAgBQ,CACtB,GAAIC,OAAQ,KAAZ,CAEAD,QAAQE,OAAR,CAAgB,SAACC,MAAD,CAAY,CACxB,GAAIA,SAAWP,KAAf,CAAsB,CAClBK,MAAQ,IAAR,CACA,MAAO,MACV,CACJ,CALD,EAOA,MAAOA,MACV,CA3BiB,CAAtB,CA8BA,GAAMG,eAAgBpB,8CAACA,CAAC,wBAAF,CAAtB,CACA,GAAMqB,gBAAiBD,cAAcE,IAAd,CAAmB,kCAAnB,CAAvB,CACA,GAAMC,mBAAoBC,oEAAGA,CAAC,CAC1BC,OAAQ,6CADkB,CAE1BC,MAAO,GAFmB,CAAJ,CAA1B,CAKA,GAAIL,eAAehB,MAAnB,CAA2B,CACvB,GAAMsB,UAAWP,cAAcE,IAAd,CAAmB,kCAAnB,CAAjB,CACA,GAAMT,KAAMc,SAASC,IAAT,CAAc,KAAd,CAAZ,CACA,GAAMC,cAAeF,SAASC,IAAT,CAAc,cAAd,CAArB,CACA,GAAMd,KAAMa,SAASC,IAAT,CAAc,KAAd,CAAZ,CACA,GAAME,cAAeH,SAASC,IAAT,CAAc,cAAd,CAArB,CAEAL,kBAAkBQ,GAAlB,CAAsB,CAClBC,SAAU,yDADQ,CAElBC,SAAU,kBAACC,EAAD,CAAK9B,GAAL,CAAa,CACnB,GAAM+B,WAAYC,OAAOhC,GAAP,CAAlB,CAEA,GAAI,CAAC+B,SAAL,CAAgB,CACZD,GAAG,KAAH,CACH,CAEDA,GAAGC,WAAatB,GAAb,EAAoBsB,WAAarB,GAApC,CACH,CAViB,CAWlBuB,4DAA6DR,YAA7D,SAAiFC,YAAjF,IAXkB,CAAtB,CAaH,CAEDP,kBAAkBQ,GAAlB,CAAsB,CAClB,CACIC,SAAU,8CADd,CAEIC,SAAU,kBAACC,EAAD,CAAK9B,GAAL,CAAa,CACnB,GAAMkC,QAASpC,cAAcC,aAAd,CAA4BC,GAA5B,CAAf,CAEA8B,GAAGI,MAAH,CACH,CANL,CAOID,aAAc,MAAKvC,OAAL,CAAayC,MAP/B,CADkB,CAUlB,CACIP,SAAU,+CADd,CAEIC,SAAU,kBAACC,EAAD,CAAK9B,GAAL,CAAa,CACnB,GAAMkC,QAASpC,cAAcI,cAAd,CAA6BF,GAA7B,CAAf,CAEA8B,GAAGI,MAAH,CACH,CANL,CAOID,aAAc,MAAKvC,OAAL,CAAa0C,OAP/B,CAVkB,CAmBlB,CACIR,SAAU,gDADd,CAEIC,SAAU,kBAACC,EAAD,CAAK9B,GAAL,CAAa,CACnB,GAAMkC,QAASpC,cAAcO,UAAd,CAAyBL,GAAzB,CAAf,CAEA8B,GAAGI,MAAH,CACH,CANL,CAOID,aAAc,MAAKvC,OAAL,CAAa2C,QAP/B,CAnBkB,CA4BlB,CACIT,SAAU,iDADd,CAEIC,SAAU,kBAACC,EAAD,CAAK9B,GAAL,CAAa,CACnB,GAAMkC,QAASpC,cAAcQ,WAAd,CAA0BN,GAA1B,CAAf,CAEA8B,GAAGI,MAAH,CACH,CANL,CAOID,aAAc,MAAKvC,OAAL,CAAa4C,SAP/B,CA5BkB,CAqClB,CACIV,SAAU,sEADd,CAEIW,YAAa,wDAFjB,CAGIV,SAAU,kBAACC,EAAD,CAAQ,CACd,GAAM9B,KAAMgB,cAAcE,IAAd,CAAmB,yCAAnB,EAA8DlB,GAA9D,EAAZ,CAEA8B,GAAG,MAAQ9B,IAAR,GAAiB,QAApB,CACH,CAPL,CAQIiC,aAAc,MAAKvC,OAAL,CAAa8C,SAR/B,CArCkB,CA+ClB,CACIZ,SAAU,4CADd,CAEIC,SAAU,kBAACC,EAAD,CAAQ,CACd,GAAM9B,KAAMgB,cAAcE,IAAd,CAAmB,qBAAnB,EAA0CuB,GAA1C,CAA8C,CAA9C,EAAiDC,OAA7D,CAEAZ,GAAG9B,GAAH,CACH,CANL,CAOIiC,aAAc,MAAKvC,OAAL,CAAaiD,YAP/B,CA/CkB,CAwDlB,CACIf,SAAU,6CADd,CAEIC,SAAU,kBAACC,EAAD,CAAQ,CACd,GAAM9B,KAAMgB,cAAcE,IAAd,CAAmB,sBAAnB,EAA2CuB,GAA3C,CAA+C,CAA/C,EAAkDC,OAA9D,CAEAZ,GAAG9B,GAAH,CACH,CANL,CAOIiC,aAAc,MAAKvC,OAAL,CAAaiD,YAP/B,CAxDkB,CAAtB,EAmEA,GAAIhD,iBAAiBM,MAArB,CAA6B,CACzB,GAAM2C,YAAa,MAAKC,yBAAL,CAA+BlD,gBAA/B,CAAnB,CAEAA,iBAAiBmD,EAAjB,CAAoB,QAApB,CAA8B,UAAM,CAChCF,WAAWG,YAAX,GAEA,GAAI,CAACH,WAAWI,MAAX,CAAkB,OAAlB,CAAL,CAAiC,CAC7B,MAAO,MACV,CACJ,CAND,CAOH,CAEDhC,cAAc8B,EAAd,CAAiB,QAAjB,CAA2B,eAAS,CAChC3B,kBAAkB4B,YAAlB,GAEA,GAAI,CAAC5B,kBAAkB6B,MAAlB,CAAyB,OAAzB,CAAL,CAAwC,CACpC,MAAOC,OAAMC,cAAN,EACV,CACJ,CAND,EAQAtD,8CAACA,CAAC,2BAAF,EAA+BuD,KAA/B,CAAqC,eAAS,CAC1CF,MAAMC,cAAN,GAEA/B,kBAAkB4B,YAAlB,GAEA,GAAI,CAAC5B,kBAAkB6B,MAAlB,CAAyB,OAAzB,CAAL,CAAwC,CACpC,MACH,CAED,GAAMI,OAAQC,2EAAYA,EAA1B,CACA,GAAMC,YAAgB1D,8CAACA,CAACqD,MAAMM,aAAR,EAAuB/B,IAAvB,CAA4B,YAA5B,CAAhB,KAA6DR,cAAcwC,SAAd,EAAnE,CAEAJ,MAAMK,IAAN,GAEAC,uEAAGA,CAACC,OAAJ,CAAYL,UAAZ,CAAwB,EAAxB,CAA4B,SAACM,GAAD,CAAMC,OAAN,CAAkB,CAC1C,GAAID,GAAJ,CAAS,CACL,MAAOR,OAAMU,aAAN,CAAoB,MAAKpE,OAAL,CAAaqE,YAAjC,CACV,CAEDX,MAAMU,aAAN,CAAoBD,OAApB,CAA6B,CAAEG,KAAM,IAAR,CAA7B,CACH,CAND,CAOH,CArBD,EAxJiB,YA8KpB,C,0BAEDnB,yB,oCAA0BoB,Y,CAAc,CACpC,GAAMC,kBAAmB9C,oEAAGA,CAAC,CACzBC,OAAQ4C,aAAa/C,IAAb,CAAkB,sBAAlB,CADiB,CAAJ,CAAzB,CAIAgD,iBAAiBvC,GAAjB,CAAqB,CACjBC,SAAUqC,aAAa/C,IAAb,CAAkB,mCAAlB,CADO,CAEjBW,QAFiB,mBAERC,EAFQ,CAEJ9B,GAFI,CAEC,CACd8B,GAAGqC,2FAAeA,CAACnE,GAAhB,CAAH,CACH,CAJgB,CAKjBiC,aAAc,oCALG,CAArB,EAQA,MAAOiC,iBACV,C,yBA/LwCE,8D,EAAxB3E,8E","file":"theme-bundle.chunk.0.js","sourcesContent":["import PageManager from './page-manager';\nimport $ from 'jquery';\nimport nod from './common/nod';\nimport giftCertChecker from './common/gift-certificate-validator';\nimport formModel from './common/models/forms';\nimport { api } from '@bigcommerce/stencil-utils';\nimport { defaultModal } from './global/modal';\n\nexport default class GiftCertificate extends PageManager {\n    constructor(context) {\n        super();\n        this.context = context;\n\n        const $certBalanceForm = $('#gift-certificate-balance');\n        $('body').addClass('gift');\n        const purchaseModel = {\n            recipientName(val) {\n                return val.length;\n            },\n            recipientEmail(...args) {\n                return formModel.email(...args);\n            },\n            senderName(val) {\n                return val.length;\n            },\n            senderEmail(...args) {\n                return formModel.email(...args);\n            },\n            customAmount(value, min, max) {\n                return value && value >= min && value <= max;\n            },\n            setAmount(value, options) {\n                let found = false;\n\n                options.forEach((option) => {\n                    if (option === value) {\n                        found = true;\n                        return false;\n                    }\n                });\n\n                return found;\n            },\n        };\n\n        const $purchaseForm = $('#gift-certificate-form');\n        const $customAmounts = $purchaseForm.find('input[name=\"certificate_amount\"]');\n        const purchaseValidator = nod({\n            submit: '#gift-certificate-form input[type=\"submit\"]',\n            delay: 300,\n        });\n\n        if ($customAmounts.length) {\n            const $element = $purchaseForm.find('input[name=\"certificate_amount\"]');\n            const min = $element.data('min');\n            const minFormatted = $element.data('minFormatted');\n            const max = $element.data('max');\n            const maxFormatted = $element.data('maxFormatted');\n\n            purchaseValidator.add({\n                selector: '#gift-certificate-form input[name=\"certificate_amount\"]',\n                validate: (cb, val) => {\n                    const numberVal = Number(val);\n\n                    if (!numberVal) {\n                        cb(false);\n                    }\n\n                    cb(numberVal >= min && numberVal <= max);\n                },\n                errorMessage: `You must enter a certificate amount between ${minFormatted} and ${maxFormatted}.`,\n            });\n        }\n\n        purchaseValidator.add([\n            {\n                selector: '#gift-certificate-form input[name=\"to_name\"]',\n                validate: (cb, val) => {\n                    const result = purchaseModel.recipientName(val);\n\n                    cb(result);\n                },\n                errorMessage: this.context.toName,\n            },\n            {\n                selector: '#gift-certificate-form input[name=\"to_email\"]',\n                validate: (cb, val) => {\n                    const result = purchaseModel.recipientEmail(val);\n\n                    cb(result);\n                },\n                errorMessage: this.context.toEmail,\n            },\n            {\n                selector: '#gift-certificate-form input[name=\"from_name\"]',\n                validate: (cb, val) => {\n                    const result = purchaseModel.senderName(val);\n\n                    cb(result);\n                },\n                errorMessage: this.context.fromName,\n            },\n            {\n                selector: '#gift-certificate-form input[name=\"from_email\"]',\n                validate: (cb, val) => {\n                    const result = purchaseModel.senderEmail(val);\n\n                    cb(result);\n                },\n                errorMessage: this.context.fromEmail,\n            },\n            {\n                selector: '#gift-certificate-form input[name=\"certificate_theme\"]:first-of-type',\n                triggeredBy: '#gift-certificate-form input[name=\"certificate_theme\"]',\n                validate: (cb) => {\n                    const val = $purchaseForm.find('input[name=\"certificate_theme\"]:checked').val();\n\n                    cb(typeof (val) === 'string');\n                },\n                errorMessage: this.context.certTheme,\n            },\n            {\n                selector: '#gift-certificate-form input[name=\"agree\"]',\n                validate: (cb) => {\n                    const val = $purchaseForm.find('input[name=\"agree\"]').get(0).checked;\n\n                    cb(val);\n                },\n                errorMessage: this.context.agreeToTerms,\n            },\n            {\n                selector: '#gift-certificate-form input[name=\"agree2\"]',\n                validate: (cb) => {\n                    const val = $purchaseForm.find('input[name=\"agree2\"]').get(0).checked;\n\n                    cb(val);\n                },\n                errorMessage: this.context.agreeToTerms,\n            },\n        ]);\n\n        if ($certBalanceForm.length) {\n            const balanceVal = this.checkCertBalanceValidator($certBalanceForm);\n\n            $certBalanceForm.on('submit', () => {\n                balanceVal.performCheck();\n\n                if (!balanceVal.areAll('valid')) {\n                    return false;\n                }\n            });\n        }\n\n        $purchaseForm.on('submit', event => {\n            purchaseValidator.performCheck();\n\n            if (!purchaseValidator.areAll('valid')) {\n                return event.preventDefault();\n            }\n        });\n\n        $('#gift-certificate-preview').click(event => {\n            event.preventDefault();\n\n            purchaseValidator.performCheck();\n\n            if (!purchaseValidator.areAll('valid')) {\n                return;\n            }\n\n            const modal = defaultModal();\n            const previewUrl = `${$(event.currentTarget).data('previewUrl')}&${$purchaseForm.serialize()}`;\n\n            modal.open();\n\n            api.getPage(previewUrl, {}, (err, content) => {\n                if (err) {\n                    return modal.updateContent(this.context.previewError);\n                }\n\n                modal.updateContent(content, { wrap: true });\n            });\n        });\n    }\n\n    checkCertBalanceValidator($balanceForm) {\n        const balanceValidator = nod({\n            submit: $balanceForm.find('input[type=\"submit\"]'),\n        });\n\n        balanceValidator.add({\n            selector: $balanceForm.find('input[name=\"giftcertificatecode\"]'),\n            validate(cb, val) {\n                cb(giftCertChecker(val));\n            },\n            errorMessage: 'You must enter a certificate code.',\n        });\n\n        return balanceValidator;\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./assets/js/theme/gift-certificate.js"],"sourceRoot":""}